@using POC.Helper
@using POC.Models

@model POC.Models.Chat
@{
    var username = Extensions.GetLoggedInUserName();
}

<!--Script references. -->
<!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
<!--Reference the SignalR library. -->
<script src="~/Scripts/jquery.signalR-2.2.0.js"></script>
<!--Reference the autogenerated SignalR hub script. *REFERENCE TO PROXY FILE* -->
<script src="~/signalr/hubs"></script>
<!--SignalR script to update the chat page and send messages.-->
<div class="container">
    <div id="UserList">
        @Html.Partial("~/Views/Chat/UserList.cshtml", Model.Users)
    </div>
    <div>
        <input type="button" id="startchat" class="btn btn-primary" value="Start Chat"/>
    </div>
    <div>
        @{
            var chatHistory = Extensions.ChatHistory;
            var items = chatHistory.Select(chat => new SelectListItem
            {
                Text = chat.ChatStart.ToShortDateString() + " " + chat.ChatStart.ToShortTimeString() + " " + chat.Participants, Value = "1"
            }).ToList();

            @Html.ListBox("chathistory", items, new { @class = "form-control" })
        }
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        sentientPOC.chat.initialize("@username");
    });
</script>

